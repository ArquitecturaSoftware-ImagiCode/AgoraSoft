<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Mi Inventario</h2>
    <div class="d-flex align-items-center">
      <!-- Debug info temporal -->
      <small class="text-muted me-3">
        Inventario ID: {{ inventarioId }} | Items: {{ itemsInventario.length }}
      </small>
      <button class="btn btn-success btn-lg shadow-sm" (click)="comprarAProveedores()">
        <i class="fas fa-shopping-cart me-2"></i> Comprar a Proveedores
      </button>
    </div>
  </div>

  <!-- Mensaje si no hay items en el inventario -->
  <div *ngIf="itemsInventario.length === 0" class="alert alert-info">
    <h4>Tu inventario está vacío</h4>
    <p>Agrega productos al inventario desde el backend usando Postman o CURL.</p>
  </div>

  <!-- Tabla de inventario -->
  <div *ngIf="itemsInventario.length > 0">
    <table class="table table-bordered table-striped">
      <thead class="table-dark">
        <tr>
          <th>Producto</th>
          <th>Descripción</th>
          <th>Precio Unitario</th>
          <th>Cantidad</th>
          <th>Valor Total</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of itemsInventario">
          <td>
            <strong>{{ item.producto.nombre }}</strong>
            <br>
            <small class="text-muted">{{ item.producto.categoria || 'Sin categoría' }}</small>
          </td>
          <td>{{ item.producto.descripcion || 'Sin descripción' }}</td>
          <td>{{ item.producto.precio | currency }}</td>
          <td>
            <!-- Mostrar cantidad normal o formulario de edición -->
            <div *ngIf="editando?.id !== item.id">
              {{ item.cantidad }}
              <span *ngIf="item.producto.unidadMedida" class="text-muted">
                {{ item.producto.unidadMedida }}
              </span>
            </div>
            <div *ngIf="editando?.id === item.id" class="d-flex align-items-center">
              <input 
                type="number" 
                [(ngModel)]="nuevaCantidad" 
                class="form-control form-control-sm me-2" 
                style="width: 80px;"
                min="0"
              >
              <button class="btn btn-sm btn-success me-1" (click)="guardarCantidad()">
                <i class="fas fa-check"></i>
                Guardar
              </button>
              <button class="btn btn-sm btn-secondary" (click)="cancelar()">
                <i class="fas fa-times"></i>
                Cancelar
              </button>
            </div>
          </td>
          <td class="fw-bold">{{ (item.producto.precio * item.cantidad) | currency }}</td>
          <td>
            <div class="btn-group" role="group">
              <button 
                class="btn btn-sm btn-warning me-1" 
                (click)="editarCantidad(item)"
                *ngIf="editando?.id !== item.id"
                title="Editar cantidad"
              >
                <i class="fas fa-edit"></i> Editar
              </button>
              <button 
                class="btn btn-sm btn-danger hover-scale" 
                (click)="eliminar(item)"
                title="Eliminar del inventario"
              >
                <i class="fas fa-trash"></i> Eliminar
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Resumen del inventario -->
    <div class="row mt-4">
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">Resumen del Inventario</h5>
          </div>
          <div class="card-body">
            <p><strong>Total de productos:</strong> {{ itemsInventario.length }}</p>
            <p><strong>Total de unidades:</strong> {{ getTotalUnidades() }}</p>
            <p><strong>Valor total del inventario:</strong> {{ getValorTotalInventario() | currency }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  